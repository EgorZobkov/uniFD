# –û—Ç—á—ë—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: Dashboard (–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å) –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã UniSite CMS

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 11 —Ñ–µ–≤—Ä–∞–ª—è 2025  
**–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:** `app/Http/Controllers/Dashboard/`  
**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤:** 30

---

## –†–µ–∑—é–º–µ

| –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|-------------|------------|
| üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è | 12 |
| üü† –í—ã—Å–æ–∫–∞—è | 18 |
| üü° –°—Ä–µ–¥–Ω—è—è | 15 |

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò

### 1. UniApiController ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | UniApiController.php |
| **–°—Ç—Ä–æ–∫–∏** | 21-97 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | –ú–µ—Ç–æ–¥—ã `authUniId()`, `checkUpdate()`, `installUpdate()`, `logoutUniId()` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞. –õ—é–±–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (uniid_token, uniid_data) –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã. |
| **–ü—Ä–∏–º–µ—Ä** | `$this->model->settings->update($auth["token"],"uniid_token");` ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å `$this->user->verificationAccess('control')->status` –≤ –Ω–∞—á–∞–ª–æ –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç–æ–¥–∞. |

---

### 2. FilemanagerController ‚Äî Path Traversal –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | FilemanagerController.php |
| **–°—Ç—Ä–æ–∫–∏** | 21-34 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | –ü—Ä–æ–≤–µ—Ä–∫–∞ `strpos($_POST['name'], "./")` –∏ `strpos($_POST['name'], "../")` –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞. –ú–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏ —á–µ—Ä–µ–∑ `....//`, `%2e%2e/`, `..%252f`, –¥–≤–æ–π–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ. |
| **–ü—Ä–∏–º–µ—Ä** | `$_POST['name'] = '....//....//etc/passwd'` |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `realpath()` –∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ –∏—Ç–æ–≥–æ–≤—ã–π –ø—É—Ç—å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –±–∞–∑–æ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∏–º—è —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ whitelist –ø–∞—Ç—Ç–µ—Ä–Ω. |

---

### 3. ImportExportController ‚Äî SSRF (Server-Side Request Forgery)

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | ImportExportController.php |
| **–°—Ç—Ä–æ–∫–∏** | 84-86 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `$_POST['link_file']` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `_file_get_contents()` –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ URL. –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ä–µ—Å—É—Ä—Å—ã (localhost, 127.0.0.1, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–ª–∞–∫–∞), —Ñ–∞–π–ª—ã –∏–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏. |
| **–ü—Ä–∏–º–µ—Ä** | `link_file = http://169.254.169.254/latest/meta-data/` (AWS) |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ IP (127.0.0.1, 10.x, 192.168.x, 169.254.x). –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å—Ö–µ–º—É (—Ç–æ–ª—å–∫–æ https). –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å whitelist –¥–æ–º–µ–Ω–æ–≤. |

---

### 4. ImportExportController ‚Äî –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏–º–ø–æ—Ä—Ç —Ç–∞–±–ª–∏—Ü—ã

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | ImportExportController.php |
| **–°—Ç—Ä–æ–∫–∞** | 91 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | –ü–∞—Ä–∞–º–µ—Ç—Ä `$_POST['table']` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –ë–î –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏. –†–∏—Å–∫ SQL Injection –∏ –∏–º–ø–æ—Ä—Ç–∞ –≤ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã. |
| **–ü—Ä–∏–º–µ—Ä** | `table = uni_users; DROP TABLE uni_users; --` |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | Whitelist –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Ç–∞–±–ª–∏—Ü –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞/—ç–∫—Å–ø–æ—Ä—Ç–∞. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `in_array($_POST['table'], $allowed_tables)`. |

---

### 5. SettingsController ‚Äî –∑–∞–ø–∏—Å—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤ robots.txt

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | SettingsController.php |
| **–°—Ç—Ä–æ–∫–∞** | 534 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `$_POST["seo_robots_data"]` –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ `robots.txt` –ø—Ä–∏ `seo_robots_manual`. –í–æ–∑–º–æ–∂–Ω–∞ –∏–Ω—ä–µ–∫—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞. |
| **–ü—Ä–∏–º–µ—Ä** | –í–Ω–µ–¥—Ä–µ–Ω–∏–µ XSS –∏–ª–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö redirect-–¥–∏—Ä–µ–∫—Ç–∏–≤ |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç robots.txt. –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã (User-agent, Disallow, Allow, Sitemap, Host). |

---

### 6. SettingsController ‚Äî –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å—å –≤ —à–∞–±–ª–æ–Ω—ã email

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | SettingsController.php |
| **–°—Ç—Ä–æ–∫–∏** | 434-437 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `$_POST["mailer_template_code"]` –∏ `$_POST["mailer_template_body"]` –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –ª—é–±–æ–π —Ñ–∞–π–ª —à–∞–±–ª–æ–Ω–∞. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ `mailer_template_code` –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ Path Traversal. |
| **–ü—Ä–∏–º–µ—Ä** | `mailer_template_code = ../../../config` |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ —à–∞–±–ª–æ–Ω–∞ —á–µ—Ä–µ–∑ `getActionCode()` –∏ whitelist. –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø—É—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ `realpath()`. |

---

### 7. TemplatesController ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ CSS/JS

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | TemplatesController.php |
| **–°—Ç—Ä–æ–∫–∏** | 209-229 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `$_POST["name"]` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—É—Ç–∏ –∫ CSS/JS —Ñ–∞–π–ª–∞–º. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ Path Traversal ‚Äî –º–æ–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å –≤ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –ø—É—Ç–∏. |
| **–ü—Ä–∏–º–µ—Ä** | `name = ../../../malicious` |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å `$_POST["name"]` ‚Äî —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, –¥–µ—Ñ–∏—Å, –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏–µ. –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ whitelist –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π. |

---

### 8. AdsController, UsersController, BlogPostController –∏ –¥—Ä. ‚Äî –º–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ ID

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª—ã** | AdsController.php, UsersController.php, BlogPostController.php, TransactionsController.php |
| **–°—Ç—Ä–æ–∫–∏** | 40, 112, 124; 419; 137; 112 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `$_POST['ids_selected']` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ `deleteMulti()`, `changeMultiStatus()` –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–∞ –∏ —Ñ–æ—Ä–º–∞—Ç–∞. –ú–∞—Å—Å–∏–≤ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–ª–∏ –±—ã—Ç—å —á—Ä–µ–∑–º–µ—Ä–Ω–æ –±–æ–ª—å—à–∏–º. |
| **–ü—Ä–∏–º–µ—Ä** | `ids_selected = [1,2,3,...,10000]` ‚Äî DoS; –∏–ª–∏ SQL injection –µ—Å–ª–∏ –º–∞—Å—Å–∏–≤ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –∑–∞–ø—Ä–æ—Å |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å: `array_map('intval', $_POST['ids_selected'])`, –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, max 100 –∑–∞ —Ä–∞–∑). |

---

### 9. AdsFiltersController ‚Äî SQL Injection –≤ id NOT IN

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | AdsFiltersController.php |
| **–°—Ç—Ä–æ–∫–∏** | 326-330 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `$idsNotDelete` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏–∑ `$_POST["items"]` –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ `implode(",", $idsNotDelete)`. –ï—Å–ª–∏ `$id` –Ω–µ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω ‚Äî SQL Injection. |
| **–ü—Ä–∏–º–µ—Ä** | `items[edit][1] = "1); DROP TABLE uni_ads_filters_items; --"` |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | `$idsNotDelete = array_map('intval', $idsNotDelete)` –ø–µ—Ä–µ–¥ `implode`. |

---

### 10. SettingsController ‚Äî SQL Injection –≤ saveSystems

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | SettingsController.php |
| **–°—Ç—Ä–æ–∫–∏** | 556-558, 580-582 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `$current_ids` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏–∑ `$_POST["system_measurement"]` –∏ `$_POST["system_price_names"]`. ID –∏–∑ `$id` –≤ foreach –ø–æ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ `id NOT IN(...)` –±–µ–∑ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è –∫ int. |
| **–ü—Ä–∏–º–µ—Ä** | –ú–∞–Ω–∏–ø—É–ª—è—Ü–∏—è `$id` –≤ –º–∞—Å—Å–∏–≤–µ POST |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | `$current_ids[] = (int)$id` –¥–ª—è –≤—Å–µ—Ö ID. |

---

### 11. DashboardController ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –≤ —Å–ª—É–∂–µ–±–Ω—ã—Ö –º–µ—Ç–æ–¥–∞—Ö

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | DashboardController.php |
| **–°—Ç—Ä–æ–∫–∏** | 21-33, 55-66, 114-119, 165-184 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | –ú–µ—Ç–æ–¥—ã `addToFavorites`, `collapsedSidebar`, `customizeTemplate`, `deleteFavorite`, `widgetRemove`, `widgetsSorting` –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç `verificationAccess`. –î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —Ç–æ–ª—å–∫–æ DashboardMiddleware, –Ω–æ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø—Ä–∞–≤–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π route_id. |
| **–ü—Ä–∏–º–µ—Ä** | –ê–¥–º–∏–Ω —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å –≤–∏–¥–∂–µ—Ç—ã –∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–µ—Å–ª–∏ –µ—Å—Ç—å –±–∞–≥ –≤ –ø—Ä–∏–≤—è–∑–∫–µ user_id). |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å `verificationAccess('view')` –∏–ª–∏ `verificationAccess('control')` –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–µ–π—Å—Ç–≤–∏—è. |

---

### 12. DashboardController ‚Äî XSS –≤ search

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | DashboardController.php |
| **–°—Ç—Ä–æ–∫–∞** | 156 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `$_POST["query"]` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ `searchCombined()` –±–µ–∑ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏. –†–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ UI ‚Äî Stored/Reflected XSS. |
| **–ü—Ä–∏–º–µ—Ä** | `query = <script>alert(1)</script>` |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –°–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–≤–æ–¥. –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –≤ —à–∞–±–ª–æ–Ω–∞—Ö. |

---

## üü† –í–´–°–û–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò

### 13. ShopsController, ReviewsController ‚Äî loadCard/loadEdit –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ control

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª—ã** | ShopsController.php (97-103), ReviewsController.php (105-108) |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `loadCard` –≤ ShopsController –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `verificationAccess`. `loadEdit` –≤ ReviewsController –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ ‚Äî –ª—é–±–æ–π —Å view –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å `verificationAccess('control')` –¥–ª—è loadEdit, `verificationAccess('view')` –¥–ª—è loadCard –≤ ShopsController. |

---

### 14. AdsFiltersController ‚Äî loadAddPodfilter, loadEdit, loadItemsFilter –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | AdsFiltersController.php |
| **–°—Ç—Ä–æ–∫–∏** | 342-356, 366-385 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | –ú–µ—Ç–æ–¥—ã –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç `verificationAccess`. `loadItemsFilter` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `$_POST['id']` –∏ `$_POST['item_id']` –≤ SQL ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ injection. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å id: `(int)$_POST['id']`. |

---

### 15. BlogPostController ‚Äî loadEdit –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | BlogPostController.php |
| **–°—Ç—Ä–æ–∫–∞** | 123 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `loadEdit` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `verificationAccess`. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å `verificationAccess('control')`. |

---

### 16. BlogPostController ‚Äî contentSave —É—è–∑–≤–∏–º–æ—Å—Ç—å

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | BlogPostController.php |
| **–°—Ç—Ä–æ–∫–∏** | 54-68 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `parse_str(urldecode($_POST['content']), $content)` ‚Äî –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä. `$content['id']` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è update. –ú–∞–Ω–∏–ø—É–ª—è—Ü–∏—è –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é —á—É–∂–æ–π –∑–∞–ø–∏—Å–∏. |
| **–ü—Ä–∏–º–µ—Ä** | –ü–µ—Ä–µ–¥–∞—á–∞ `content[id]=1` –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –∑–∞–ø–∏—Å–∏ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å `$content['id']`. –ü—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ –ø–æ—Å—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –¥–æ–ø—É—Å—Ç–∏–º–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—É. |

---

### 17. AdvertisingController ‚Äî loadEdit, geoSearch –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | AdvertisingController.php |
| **–°—Ç—Ä–æ–∫–∏** | 213-218, 204-208 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `loadEdit`, `sliderLoadAdd` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ø—Ä–∞–≤–∞. `geoSearch` –¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ ‚Äî –≤–æ–∑–º–æ–∂–Ω–∞ —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å `verificationAccess('control')` –¥–ª—è loadEdit. `verificationAccess('view')` –¥–ª—è geoSearch. |

---

### 18. ServicesController ‚Äî loadEditService, loadEditTariff –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | ServicesController.php |
| **–°—Ç—Ä–æ–∫–∏** | 218-230 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | –ú–µ—Ç–æ–¥—ã –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç `verificationAccess`. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å `verificationAccess('control')`. |

---

### 19. CountriesController ‚Äî loadEdit* –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | CountriesController.php |
| **–°—Ç—Ä–æ–∫–∏** | 529-555 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `loadEditCity`, `loadEditCityDistrict`, `loadEditCityMetro`, `loadEditCountry`, `loadEditRegion` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ø—Ä–∞–≤–∞. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å `verificationAccess('control')` –∏–ª–∏ `verificationAccess('view')`. |

---

### 20. SearchController ‚Äî loadEditKeyword –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | SearchController.php |
| **–°—Ç—Ä–æ–∫–∞** | 205 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `loadEditKeyword` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å `verificationAccess('control')`. |

---

### 21. ImportExportController ‚Äî loadEditFeed –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | ImportExportController.php |
| **–°—Ç—Ä–æ–∫–∞** | 315 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `loadEditFeed` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `verificationAccess`. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å `verificationAccess('control')`. |

---

### 22. SettingsController ‚Äî mailingLoadTemplate –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | SettingsController.php |
| **–°—Ç—Ä–æ–∫–∏** | 193-200 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `mailingLoadTemplate` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞. `$_POST["code"]` –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —á—Ç–µ–Ω–∏—é –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å `verificationAccess('control')`. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å `code` —á–µ—Ä–µ–∑ whitelist. |

---

### 23. AdsController, DealsController ‚Äî loadDataChart –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª—ã** | AdsController.php (84-88), DealsController.php (96-100) |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `loadDataChartMonth` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `verificationAccess` ‚Äî —É—Ç–µ—á–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å `verificationAccess('view')`. |

---

### 24. MobileAppStatController ‚Äî loadDataChartWeekAndMonth –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | MobileAppStatController.php |
| **–°—Ç—Ä–æ–∫–∞** | 21 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `loadDataChartWeekAndMonth` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏, –µ—Å–ª–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ AJAX. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å `verificationAccess('view')`. |

---

### 25. UsersController ‚Äî sendAccess –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ email

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | UsersController.php |
| **–°—Ç—Ä–æ–∫–∏** | 616-625 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `sendAccess` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∞—Ä–æ–ª—å –Ω–∞ `$_POST['email']` –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ. –í–æ–∑–º–æ–∂–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π email. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –ü—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ email –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ —Å–∏—Å—Ç–µ–º–µ. –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –æ—Ç–ø—Ä–∞–≤–∫–∏. |

---

### 26. ChatController ‚Äî editAutomessages –º–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ ID –∏–∑ POST

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | ChatController.php |
| **–°—Ç—Ä–æ–∫–∏** | 271-289 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `foreach ($_POST["actions"] as $id => $value)` ‚Äî `$id` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ update –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | `$id = (int)$id` –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º. |

---

### 27. AdsFiltersController ‚Äî insertListItems XSS

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | AdsFiltersController.php |
| **–°—Ç—Ä–æ–∫–∞** | 319 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `trimStr($value, 128)` –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ HTML –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è. Stored XSS. |
| **–ü—Ä–∏–º–µ—Ä** | `value = <script>alert(1)</script>` |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `htmlspecialchars()` –ø—Ä–∏ –≤—ã–≤–æ–¥–µ. |

---

### 28. AdsFiltersController ‚Äî filtersSorting, insertListItems –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | AdsFiltersController.php |
| **–°—Ç—Ä–æ–∫–∏** | 300-308, 312-331 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü† –í—ã—Å–æ–∫–∞—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `filtersSorting` –∏ `insertListItems` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç `verificationAccess('control')`. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤. |

---

## üü° –°–†–ï–î–ù–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò

### 29. –ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ sorting –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª—ã** | AdsCategoriesController (381-388), BlogCategoriesController (213-221), ServicesController (246-263) |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü° –°—Ä–µ–¥–Ω—è—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `sorting` –º–µ—Ç–æ–¥—ã –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç `verificationAccess('control')`. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É. |

---

### 30. AdsCategoriesController ‚Äî loadTemplateFilterItems SQL Injection

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | AdsCategoriesController.php |
| **–°—Ç—Ä–æ–∫–∞** | 345 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü° –°—Ä–µ–¥–Ω—è—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `implode(",", $getIdFilters)` –≤ SQL ‚Äî –µ—Å–ª–∏ `getFiltersByCategory` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ—Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `getFiltersByCategory`. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `array_map('intval', $getIdFilters)`. |

---

### 31. FilemanagerController ‚Äî uploadFiles –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ images

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | FilemanagerController.php |
| **–°—Ç—Ä–æ–∫–∞** | 130 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü° –°—Ä–µ–¥–Ω—è—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `extList('images')` –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ç–∏–ø—ã. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `extList` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç (–≤ —Ç.—á. .phtml, .php5). |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –Ø–≤–Ω—ã–π whitelist —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π: jpg, jpeg, png, gif, webp. |

---

### 32. ChatController ‚Äî send –±–µ–∑ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ attach_files

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | ChatController.php |
| **–°—Ç—Ä–æ–∫–∏** | 377-383 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü° –°—Ä–µ–¥–Ω—è—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `$_POST['attach_files']` ‚Äî –º–∞—Å—Å–∏–≤ –ø—É—Ç–µ–π/–∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤. –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ temp –∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç —Å–µ—Å—Å–∏–∏. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –∫–∞–∂–¥—ã–π —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ temp –∏ –±—ã–ª –∑–∞–≥—Ä—É–∂–µ–Ω —Ç–µ–∫—É—â–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º. |

---

### 33. AuthorizeController ‚Äî restorePass —Å—á—ë—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | AuthorizeController.php |
| **–°—Ç—Ä–æ–∫–∞** | 186 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü° –°—Ä–µ–¥–Ω—è—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `dashboard-login-forgot-attempts` —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è. –õ–æ–≥–∏—á–µ—Å–∫–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –°–±—Ä–∞—Å—ã–≤–∞—Ç—å —Å—á—ë—Ç—á–∏–∫ –ø—Ä–∏ —É—Å–ø–µ—Ö–µ. |

---

### 34. –£—Ç–µ—á–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –æ—Ç–≤–µ—Ç–∞—Ö (–º–∞—Å—Å–∏–≤—ã –≤–º–µ—Å—Ç–æ json_answer)

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª—ã** | DealsController (96-100), AdsController (84-88) |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü° –°—Ä–µ–¥–Ω—è—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | `loadDataChartMonth` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `["week"=>..., "month"=>...]` ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∏–Ω–∞—á–µ –∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É—Ç–µ—á–∫–µ. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤–æ–∑–≤—Ä–∞—Ç —á–µ—Ä–µ–∑ `json_answer()`. |

---

### 35. ShopsController ‚Äî loadCard –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç null check –¥–ª—è $data

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–§–∞–π–ª** | ShopsController.php |
| **–°—Ç—Ä–æ–∫–∏** | 97-103 |
| **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å** | üü° –°—Ä–µ–¥–Ω—è—è |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | –ï—Å–ª–∏ `find` –≤–µ—Ä–Ω—ë—Ç null, `$data->user` –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É. |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | –î–æ–±–∞–≤–∏—Ç—å `if(!$data) return json_answer(["status"=>false]);`. |

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:** UniApiController ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤; FilemanagerController ‚Äî —É—Å–∏–ª–∏—Ç—å –∑–∞—â–∏—Ç—É Path Traversal; ImportExportController ‚Äî SSRF –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è table.
2. **–í —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏:** SettingsController ‚Äî robots.txt, mailer —à–∞–±–ª–æ–Ω—ã; TemplatesController ‚Äî Path Traversal; AdsFiltersController ‚Äî SQL Injection.
3. **–í —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞:** –î–æ–±–∞–≤–∏—Ç—å `verificationAccess` –≤–æ –≤—Å–µ load* –º–µ—Ç–æ–¥—ã; –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å `ids_selected` –≤–æ –≤—Å–µ—Ö –º–∞—Å—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö.

---

## –û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –í–Ω–µ–¥—Ä–∏—Ç—å **CSRF-—Ç–æ–∫–µ–Ω—ã** –¥–ª—è –≤—Å–µ—Ö POST-–∑–∞–ø—Ä–æ—Å–æ–≤.
- –î–æ–±–∞–≤–∏—Ç—å **rate limiting** –¥–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (–∏–º–ø–æ—Ä—Ç, —Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è, –æ—Ç–ø—Ä–∞–≤–∫–∞ email).
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–∫—Ç–æ, —á—Ç–æ, –∫–æ–≥–¥–∞).
- –ü—Ä–æ–≤–µ—Å—Ç–∏ **—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** –∫–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, PHPStan, Psalm) –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø–æ–¥–æ–±–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.
