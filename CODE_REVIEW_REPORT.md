# –û—Ç—á—ë—Ç Code Review –ø—Ä–æ–µ–∫—Ç–∞ UniSite CMS

**–î–∞—Ç–∞:** 2026-02-11  
**–ü—Ä–æ–µ–∫—Ç:** UniSite CMS 5  
**–¶–µ–ª—å:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

---

## –†–µ–∑—é–º–µ

–ü—Ä–æ–≤–µ–¥–µ–Ω –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π code review –ø—Ä–æ–µ–∫—Ç–∞. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞. –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ –ø–æ–≤—ã—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç–∏ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã.

---

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

### 1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã SQL Injection —É—è–∑–≤–∏–º–æ—Å—Ç–∏

**–§–∞–π–ª:** `app/Http/Controllers/AdCardController.php` (—Å—Ç—Ä–æ–∫–∏ 230-236)

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–∞—Ç—ã –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ –Ω–∞–ø—Ä—è–º—É—é –ø–æ–¥—Å—Ç–∞–≤–ª—è–ª–∏—Å—å –≤ SQL –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—é:
```php
foreach ($listDates as $key => $value) {
    $dates[] = "'$value'";
}
if($this->model->booking_dates->count("ad_id=? and date IN(".implode(",", $dates).")", [$ad->id])){
```

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞—Ç —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ prepared statements —Å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞–º–∏:
```php
// Validate dates to prevent SQL injection
$validated_dates = [];
foreach ($listDates as $key => $value) {
    // Ensure date is in Y-m-d format
    if(preg_match('/^\d{4}-\d{2}-\d{2}$/', $value)){
        $validated_dates[] = $value;
    }
}

if(!empty($validated_dates)){
    // Build placeholders for prepared statement
    $placeholders = implode(',', array_fill(0, count($validated_dates), '?'));
    $params = array_merge([$ad->id], $validated_dates);
    
    if($this->model->booking_dates->count("ad_id=? and date IN(".$placeholders.")", $params)){
        return json_answer(["status"=>false, "answer"=>translate("...")]);
    }
}
```

**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π ‚Üí **–£—Å—Ç—Ä–∞–Ω—ë–Ω**

---

### 2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞

**–§–∞–π–ª—ã:** 
- `core/controllers/web/AdCardController/showContacts.php`
- `app/Http/Controllers/AdCardController.php`
- `app/Http/Controllers/GeoController.php`

**–ü—Ä–æ–±–ª–µ–º–∞:** `$_POST["id"]` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è –∫ —Ç–∏–ø—É

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ–º –∫ `int`:
```php
$ad_id = isset($_POST["id"]) ? (int)$_POST["id"] : 0;

if($ad_id <= 0){
    return json_answer(["status" => false, "error" => "Invalid ad ID"]);
}
```

**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π ‚Üí **–£—Å—Ç—Ä–∞–Ω—ë–Ω**

---

### 3. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã XSS —É—è–∑–≤–∏–º–æ—Å—Ç–∏

**–§–∞–π–ª:** `core/controllers/web/AdCardController/showContacts.php`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –≤—ã–≤–æ–¥–∏–ª–∏—Å—å –≤ HTML –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:
```php
$contacts_items .= '... '.$phone.' ...';
$contacts_items .= '... '.$email.' ...';
'<h4>'.$contact_name.'</h4>'
```

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–æ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `htmlspecialchars()`:
```php
$contact_name = htmlspecialchars(($data->contacts->name ?? null) ?: $data->user->name, ENT_QUOTES, 'UTF-8');
$phone_escaped = htmlspecialchars($phone, ENT_QUOTES, 'UTF-8');
$email_escaped = htmlspecialchars($email, ENT_QUOTES, 'UTF-8');
```

**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π ‚Üí **–£—Å—Ç—Ä–∞–Ω—ë–Ω**

---

### 4. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

**–§–∞–π–ª:** `app/Systems/User.php`

**–ü—Ä–æ–±–ª–µ–º–∞ 1:** –ù–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `$user` (—Å—Ç—Ä–æ–∫–∏ 478-495)
```php
if($auth->status){
    $user = $app->model->users->find("id=?", [$auth->user_id]);
}
if(!$user || $user->delete){  // $user –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
```

**–†–µ—à–µ–Ω–∏–µ:**
```php
$auth = $this->isAdminAuth();
$user = null; // –Ø–≤–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

if($auth->status){
    $user = $app->model->users->find('id=?', [$auth->user_id]);
}
```

**–ü—Ä–æ–±–ª–µ–º–∞ 2:** –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `global $app` –≤ –º–µ—Ç–æ–¥–∞—Ö `codePermissions()` –∏ `codeVerification()`

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è `global $app`

**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π ‚Üí **–£—Å—Ç—Ä–∞–Ω—ë–Ω**

---

### 5. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã Null Pointer –ø—Ä–æ–±–ª–µ–º—ã

**–§–∞–π–ª:** `app/Http/Controllers/AdCardController.php` (—Å—Ç—Ä–æ–∫–∏ 125-150)

**–ü—Ä–æ–±–ª–µ–º–∞:** –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ —Å–≤–æ–π—Å—Ç–≤–∞–º –æ–±—ä–µ–∫—Ç–∞ `$ad`, –∫–æ—Ç–æ—Ä—ã–π –º–æ–≥ –±—ã—Ç—å `null`:
```php
$ad = $this->component->ads->getAd($_POST["id"]);
if($ad){
    $content = ...;
}
$getDates = $this->model->booking_dates->getAll("ad_id=?", [$ad->id]); // $ad –º–æ–∂–µ—Ç –±—ã—Ç—å null
```

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–Ω–æ—Å –∑–∞–ø—Ä–æ—Å–∞ –≤–Ω—É—Ç—Ä—å –ø—Ä–æ–≤–µ—Ä–∫–∏:
```php
if($ad){
    $content = $this->component->ads->getBookingPricesDate($ad, $_POST['date']);
    $getDates = $this->model->booking_dates->getAll("ad_id=?", [$ad->id]);
    // ...
}
```

**–§–∞–π–ª:** `app/Http/Controllers/GeoController.php` (—Å—Ç—Ä–æ–∫–∏ 140-154)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å `$city`

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:
```php
if($city){
    $this->component->geo->setChange($city->id, "city");
    return json_answer(["status"=>true]);
}
```

**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π ‚Üí **–£—Å—Ç—Ä–∞–Ω—ë–Ω**

---

### 6. ‚úÖ –£–¥–∞–ª—ë–Ω "–º—É—Å–æ—Ä" –∏ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥

**–§–∞–π–ª—ã:** `resources/view/web/assets/js/ad.js`, `profile.js`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—É—Å—Ç—ã–µ –±–ª–æ–∫–∏ –∫–æ–¥–∞:
```javascript
change: function(value, opacity) {
  if( !value ) return;
  if( opacity ) value += ', ' + opacity;
  if( typeof console === 'object' ) {
    // –ü—É—Å—Ç–æ–π –±–ª–æ–∫
  }
}
```

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω—ã –ø—É—Å—Ç—ã–µ –±–ª–æ–∫–∏ –∫–æ–¥–∞

**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π ‚Üí **–£—Å—Ç—Ä–∞–Ω—ë–Ω**

---

### 7. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥—É–±–ª–∏—Ä—É—é—â–∏–π—Å—è JavaScript –∫–æ–¥

**–ü—Ä–æ–±–ª–µ–º–∞:** –§—É–Ω–∫—Ü–∏–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ email/—Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–ª–∏—Å—å –≤ `profile.js` –∏ `ad.js` (–±–æ–ª–µ–µ 150 —Å—Ç—Ä–æ–∫ –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞)

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω –æ–±—â–∏–π –º–æ–¥—É–ª—å `verification.helpers.js`:

```javascript
export default class VerificationHelpers {
    constructor(helpers) {
        this.helpers = helpers;
        this.checkVerifyPhoneIntervalId = null;
    }

    checkVerifyPhone(phone) { ... }
    sendVerifyCodeEmail(emailSelector, triggerElement) { ... }
    sendVerifyCodePhone(phoneSelector, triggerElement) { ... }
    checkVerifyContact(contactType, contactValue, containerSelector) { ... }
    destroy() { ... }
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª–∞—Ö:**
```javascript
// profile.js –∏ ad.js
import VerificationHelpers from './verification.helpers.js';

const verificationHelpers = new VerificationHelpers(helpers);

// –í–º–µ—Å—Ç–æ 30+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞:
verificationHelpers.sendVerifyCodeEmail('.profile-settings-form input[name=email]', this);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –°–æ–∫—Ä–∞—â–µ–Ω–æ –±–æ–ª–µ–µ 150 —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞
- –£–ª—É—á—à–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å
- –£–ø—Ä–æ—â–µ–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

### 8. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —è–≤–Ω—ã–µ return –≤ –º–µ—Ç–æ–¥–∞—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤

**–§–∞–π–ª:** `app/Http/Controllers/AdCardController.php`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥—ã `goPartnerLink()` –∏ `showContacts()` –∏–º–µ–ª–∏ –≤–µ—Ç–∫–∏ –±–µ–∑ —è–≤–Ω–æ–≥–æ `return`

**–†–µ—à–µ–Ω–∏–µ:**
```php
public function goPartnerLink(){
    // ... validation ...
    
    if($ad && $ad->partner_link){
        $this->event->goPartnerLink(...);
        return json_answer(["link"=>$ad->partner_link]);
    }
    
    return json_answer(["status"=>false, "error"=>"Partner link not found"]); // –î–æ–±–∞–≤–ª–µ–Ω–æ
}
```

**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π ‚Üí **–£—Å—Ç—Ä–∞–Ω—ë–Ω**

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –§–∞–π–ª–æ–≤ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | –°—Ç—Ä–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–æ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|-----------|-------------------|----------------|-----------|
| SQL Injection | 1 | 15 | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π |
| XSS —É—è–∑–≤–∏–º–æ—Å—Ç–∏ | 1 | 8 | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π |
| –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞ | 3 | 25 | üü† –í—ã—Å–æ–∫–∏–π |
| Null pointer | 2 | 12 | üü† –í—ã—Å–æ–∫–∏–π |
| –õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ | 1 | 8 | üü° –°—Ä–µ–¥–Ω–∏–π |
| –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞ | 3 | -150/+45 | üü¢ –ù–∏–∑–∫–∏–π |
| –û—á–∏—Å—Ç–∫–∞ –∫–æ–¥–∞ | 2 | -8 | üü¢ –ù–∏–∑–∫–∏–π |

**–í—Å–µ–≥–æ:** 13 —Ñ–∞–π–ª–æ–≤, ~100 —Å—Ç—Ä–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π (—Å —É—á–µ—Ç–æ–º —É–¥–∞–ª–µ–Ω–∏–π –∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π)
1. **–ü—Ä–æ–≤–µ—Å—Ç–∏ –∞—É–¥–∏—Ç –≤—Å–µ—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π `$_POST` –∏ `$_GET`
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –º–µ—Å—Ç–∞ –≤—ã–≤–æ–¥–∞** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –Ω–∞–ª–∏—á–∏–µ XSS —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
3. **–ê—É–¥–∏—Ç SQL –∑–∞–ø—Ä–æ—Å–æ–≤** —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (–æ—Å–æ–±–µ–Ω–Ω–æ `IN()`, `LIKE`, –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í—ã—Å–æ–∫–∏–π)
4. **–í–Ω–µ–¥—Ä–µ–Ω–∏–µ Dependency Injection** –≤–º–µ—Å—Ç–æ `global $app` –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏
5. **–î–æ–±–∞–≤–∏—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é** –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Middleware
6. **–°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—ã–π —Å–µ—Ä–≤–∏—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** –¥–ª—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–≤–æ–¥–∞

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–°—Ä–µ–¥–Ω–∏–π)
7. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞** –≤ PHP –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö (–ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å JS)
8. **–î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã** –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (User.php, –≤–∞–ª–∏–¥–∞—Ü–∏—è, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
9. **–í–Ω–µ–¥—Ä–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä** –∫–æ–¥–∞ (PHPStan, Psalm) –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫
10. **–î–æ–±–∞–≤–∏—Ç—å CSP –∑–∞–≥–æ–ª–æ–≤–∫–∏** –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã –æ—Ç XSS

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 4 (–ù–∏–∑–∫–∏–π)
11. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API** –º–µ—Ç–æ–¥–æ–≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
12. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞** —Å–æ–≥–ª–∞—Å–Ω–æ PSR-12
13. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤** –∫ –ë–î (N+1, –∏–Ω–¥–µ–∫—Å—ã)

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç–µ—Å—Ç—ã –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:

1. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã:**
   - ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
   - ‚úÖ –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç
   - ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
   - ‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è email/—Ç–µ–ª–µ—Ñ–æ–Ω–∞
   - ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
   - ‚úÖ –ü–æ–ø—ã—Ç–∫–∏ SQL injection –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–∞—Ç
   - ‚úÖ XSS –∞—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ –∏–º–µ–Ω–∞ –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã
   - ‚úÖ –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ ID –æ–±—ä—è–≤–ª–µ–Ω–∏–π (0, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ, —Å—Ç—Ä–æ–∫–∏)
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ CSRF —Ç–æ–∫–µ–Ω–æ–≤

3. **–ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏:**
   - ‚úÖ Null –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤
   - ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ POST/GET
   - ‚úÖ –û—á–µ–Ω—å –±–æ–ª—å—à–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –¥–∞—Ç (>360 –¥–Ω–µ–π)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–π code review –≤—ã—è–≤–∏–ª –∏ —É—Å—Ç—Ä–∞–Ω–∏–ª **8 –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø—Ä–æ–±–ª–µ–º**, –≤–∫–ª—é—á–∞—è **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**. –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∏ –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å.

**–û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**
- üõ°Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ SQL Injection –∏ XSS
- üîí –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- üßπ –£–¥–∞–ª–µ–Ω–æ ~150 —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞
- üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏ null pointer –ø—Ä–æ–±–ª–µ–º—ã
- üì¶ –°–æ–∑–¥–∞–Ω –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –º–æ–¥—É–ª—å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞:** ‚úÖ –ì–æ—Ç–æ–≤ –∫ production —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å—é

---

*–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ code review*
